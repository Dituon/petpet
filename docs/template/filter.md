# Image Filter

通过滤镜实现头像特效, Java 与 JavaScript 版本实现有偏差, 并非完全相同

```jsonc
{
  "filter": [
    {
      "type": "swirl",
      "radius": 200,
      "angle": 5
    }
  ]
}
```

## 动画

参数可使用数组实现动画, 例如:

```jsonc
{
  "type": "gif",
  "canvas": {
    "width": 800,
    "height": 800,
    "length": 5         // 动画帧数
  },
  "elements": [{
    "type": "image",
    "key": "to",
    "coords": [0, 0, "100vw", "100vh"],
    "filter": [{
      "type": "swirl",
      "angle": [0, 1.2, 2.4, 3.6, 4.8] // 对应每一帧动画
    }]
  }]
}
```

<details><summary>实现差异对比</summary>

![实现差异对比](https://s2.loli.net/2023/11/01/n5dZ2SyQkNFWzCu.jpg)

</details>

## 滤镜类型

- `swirl` , 漩涡滤镜

| **属性**     | **类型** | **注释**           | **默认值** |
|------------|--------|------------------|---------|
| **radius** | float  | 涡旋半径, 值为0时表示图片半径 | `0.0`   |
| **angle**  | float  | 涡旋角度             | `3.0`   |
| **x**      | float  | 中心点X坐标百分比        | `0.5`   |
| **y**      | float  | 中心点Y坐标百分比        | `0.5`   |

- `bulge` , 膨胀收缩滤镜

| **属性**       | **类型** | **注释**                    | **默认值** |
|--------------|--------|---------------------------|---------|
| **radius**   | float  | 膨胀半径, 值为0时表示图片半径          | `0.0`   |
| **strength** | float  | 膨胀强度 `[-1, 1]`, 负数时产生收缩效果 | `0.5`   |
| **x**        | float  | 中心点X坐标百分比                 | `0.5`   |
| **y**        | float  | 中心点Y坐标百分比                 | `0.5`   |

- `swim` , 水下滤镜

| **属性**         | **类型** | **注释** | **默认值** |
|----------------|--------|--------|---------|
| **scale**      | float  | 缩放系数   | `32.0`  |
| **stretch**    | float  | 拉伸系数   | `1.0`   |
| **angle**      | float  | 角度     | `0.0`   |
| **amount**     | float  | 强度     | `10.0`  |
| **turbulence** | float  | 湍流系数   | `1.0`   |
| **time**       | float  | 时间     | `0.0`   |

- `blur` , 模糊滤镜

| **属性**     | **类型** | **注释** | **默认值** |
|------------|--------|--------|---------|
| **radius** | float  | 模糊半径   | `10.0`  |

- `contrast` , 亮度对比度滤镜

| **属性**         | **类型** | **注释** | **默认值** |
|----------------|--------|--------|---------|
| **brightness** | float  | 亮度     | `0.0`   |
| **contrast**   | float  | 对比度    | `0.0`   |

- `hsb` , 相对HSB (色相, 饱和度, 亮度) 滤镜

| **属性**         | **类型** | **注释** | **默认值** |
|----------------|--------|--------|---------|
| **hue**        | float  | 色相     | `0.0`   |
| **saturation** | float  | 饱和度    | `0.0`   |
| **brightness** | float  | 亮度     | `0.0`   |

- `halftone` , 半色调滤镜 (模仿彩色印刷的CMYK色彩)

| **属性**     | **类型** | **注释**    | **默认值** |
|------------|--------|-----------|---------|
| **angle**  | float  | 角度        | `0.0`   |
| **radius** | float  | 半径        | `4.0`   |
| **x**      | float  | 中心点X坐标百分比 | `0.5`   |
| **y**      | float  | 中心点Y坐标百分比 | `0.5`   |

- `dot_screen` , 单色点阵滤镜 (模仿黑白印刷品)

| **属性**     | **类型** | **注释**    | **默认值** |
|------------|--------|-----------|---------|
| **angle**  | float  | 角度        | `0.0`   |
| **radius** | float  | 半径        | `4.0`   |
| **x**      | float  | 中心点X坐标百分比 | `0.5`   |
| **y**      | float  | 中心点Y坐标百分比 | `0.5`   |

- `noise` , 噪声滤镜

| **属性**     | **类型** | **注释** | **默认值** |
|------------|--------|--------|---------|
| **amount** | float  | 噪声强度   | `0.25`  |

- `denoise` , 降噪滤镜

| **属性**       | **类型** | **注释** | **默认值** |
|--------------|--------|--------|---------|
| **exponent** | float  | 指数     | `20.0`  |

- `oil` , 油画滤镜

| **属性**     | **类型** | **注释** | **默认值** |
|------------|--------|--------|---------|
| **skip**   | float  | 迭代跨越系数 | `4.0`   |
| **range**  | float  | 迭代范围   | `12.0`  |
| **levels** | float  | 等级     | `8.0`   |

- `mirage` , 幻影坦克滤镜 (父元素为表图)

| **属性**          | **类型**                          | **注释**                            | **默认值**     |
|-----------------|---------------------------------|-----------------------------------|-------------|
| **key**         | string                          | 里图键名, 类似于 [image.key](./image.md) | `"unknown"` |
| **default**     | [ImageSrc](./image.md#imagesrc) | 里图默认地址                            | 无           |
| **inner_scale** | float                           | 里图缩放系数                            | `0.3`       |
| **cover_scale** | float                           | 表图缩放系数                            | `0.8`       |
| **inner_desat** | float                           | 里图去色系数                            | `0.0`       |
| **cover_desat** | float                           | 表图去色系数                            | `0.0`       |
| **weight**      | float                           | 滤镜权重                              | `0.7`       |
| **max_size**    | int                             | 最大尺寸, 单位为 px                      | `1200`      |
| **colored**     | boolean                         | 是否为彩色                             | `true`      |

> 由于 GIF 标准不支持 Alpha 透明度, **本滤镜不支持 GIF 格式**

- `gray` , 灰度化滤镜

无参数

- `binarize` , 二值化滤镜

无参数

- `mirror` , 水平翻转滤镜

无参数

- `flip` , 垂直翻转滤镜

无参数
